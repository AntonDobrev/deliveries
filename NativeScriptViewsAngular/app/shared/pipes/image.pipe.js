"use strict";
var core_1 = require("@angular/core");
var empty1x1png = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=";
var ImagePipe = (function () {
    function ImagePipe() {
    }
    ImagePipe.prototype.transform = function (value, args) {
        var img, type, provider;
        if (typeof (value) === "undefined") {
            return empty1x1png;
        }
        type = args[0];
        provider = args[1];
        if (!this._isAbsolute(value)) {
            if (type === "everlive") {
                var setup = provider.setup;
                img = setup.scheme + ":" + setup.url + setup.apiKey + "/Files/" + value + "/Download";
            }
            else if (type === "sitefinity") {
                var url = provider.profileUrl, startIndex = url.indexOf("//") + 2, endIndex = url.indexOf("/", startIndex), destination = endIndex === -1 ? url : url.substr(0, endIndex);
                img = destination + img;
            }
            else {
                img = empty1x1png;
            }
        }
        return img;
    };
    ImagePipe.prototype._isAbsolute = function (src) {
        if (src && (src.slice(0, 5) === "http:" || src.slice(0, 6) === "https:" || src.slice(0, 2) === "//" || src.slice(0, 5) === "data:")) {
            return true;
        }
        return false;
    };
    return ImagePipe;
}());
ImagePipe = __decorate([
    core_1.Pipe({
        name: "nsImage"
    })
], ImagePipe);
exports.ImagePipe = ImagePipe;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UucGlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImltYWdlLnBpcGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNDQUFvRDtBQUVwRCxJQUFNLFdBQVcsR0FBVyxvSEFBb0gsQ0FBQztBQUtqSixJQUFhLFNBQVM7SUFBdEI7SUFvQ0EsQ0FBQztJQW5DQyw2QkFBUyxHQUFULFVBQVUsS0FBVSxFQUFFLElBQVc7UUFDL0IsSUFBSSxHQUFXLEVBQUUsSUFBWSxFQUFFLFFBQWEsQ0FBQztRQUU3QyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssV0FBVyxDQUFDLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsV0FBVyxDQUFDO1FBQ3JCLENBQUM7UUFFRCxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2YsUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVuQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzdCLEVBQUUsQ0FBQyxDQUFDLElBQUksS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUN4QixJQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsS0FBSyxDQUFDO2dCQUMzQixHQUFHLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxHQUFHLEdBQUcsS0FBSyxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsTUFBTSxHQUFHLFNBQVMsR0FBRyxLQUFLLEdBQUcsV0FBVyxDQUFDO1lBQ3hGLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxLQUFLLFlBQVksQ0FBQyxDQUFDLENBQUM7Z0JBQ2pDLElBQUksR0FBRyxHQUFHLFFBQVEsQ0FBQyxVQUFVLEVBQzNCLFVBQVUsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFDbEMsUUFBUSxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxFQUN2QyxXQUFXLEdBQUcsUUFBUSxLQUFLLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztnQkFDaEUsR0FBRyxHQUFHLFdBQVcsR0FBRyxHQUFHLENBQUM7WUFDMUIsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNOLEdBQUcsR0FBRyxXQUFXLENBQUM7WUFDcEIsQ0FBQztRQUNILENBQUM7UUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUVPLCtCQUFXLEdBQW5CLFVBQW9CLEdBQVc7UUFDN0IsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssT0FBTyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLFFBQVEsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxJQUFJLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BJLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBRUQsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNmLENBQUM7SUFDSCxnQkFBQztBQUFELENBQUMsQUFwQ0QsSUFvQ0M7QUFwQ1ksU0FBUztJQUhyQixXQUFJLENBQUM7UUFDSixJQUFJLEVBQUUsU0FBUztLQUNoQixDQUFDO0dBQ1csU0FBUyxDQW9DckI7QUFwQ1ksOEJBQVMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQaXBlLCBQaXBlVHJhbnNmb3JtIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuY29uc3QgZW1wdHkxeDFwbmc6IHN0cmluZyA9IFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBRUFBQUFCQ0FRQUFBQzFIQXdDQUFBQUMwbEVRVlFJMTJOZ1lBQUFBQU1BQVNEVmxNY0FBQUFBU1VWT1JLNUNZSUk9XCI7XG5cbkBQaXBlKHtcbiAgbmFtZTogXCJuc0ltYWdlXCJcbn0pXG5leHBvcnQgY2xhc3MgSW1hZ2VQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XG4gIHRyYW5zZm9ybSh2YWx1ZTogYW55LCBhcmdzOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgbGV0IGltZzogc3RyaW5nLCB0eXBlOiBzdHJpbmcsIHByb3ZpZGVyOiBhbnk7XG5cbiAgICBpZiAodHlwZW9mICh2YWx1ZSkgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHJldHVybiBlbXB0eTF4MXBuZztcbiAgICB9XG5cbiAgICB0eXBlID0gYXJnc1swXTtcbiAgICBwcm92aWRlciA9IGFyZ3NbMV07XG5cbiAgICBpZiAoIXRoaXMuX2lzQWJzb2x1dGUodmFsdWUpKSB7XG4gICAgICBpZiAodHlwZSA9PT0gXCJldmVybGl2ZVwiKSB7XG4gICAgICAgIGxldCBzZXR1cCA9IHByb3ZpZGVyLnNldHVwO1xuICAgICAgICBpbWcgPSBzZXR1cC5zY2hlbWUgKyBcIjpcIiArIHNldHVwLnVybCArIHNldHVwLmFwaUtleSArIFwiL0ZpbGVzL1wiICsgdmFsdWUgKyBcIi9Eb3dubG9hZFwiO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInNpdGVmaW5pdHlcIikge1xuICAgICAgICBsZXQgdXJsID0gcHJvdmlkZXIucHJvZmlsZVVybCxcbiAgICAgICAgICBzdGFydEluZGV4ID0gdXJsLmluZGV4T2YoXCIvL1wiKSArIDIsXG4gICAgICAgICAgZW5kSW5kZXggPSB1cmwuaW5kZXhPZihcIi9cIiwgc3RhcnRJbmRleCksXG4gICAgICAgICAgZGVzdGluYXRpb24gPSBlbmRJbmRleCA9PT0gLTEgPyB1cmwgOiB1cmwuc3Vic3RyKDAsIGVuZEluZGV4KTtcbiAgICAgICAgaW1nID0gZGVzdGluYXRpb24gKyBpbWc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbWcgPSBlbXB0eTF4MXBuZztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW1nO1xuICB9XG5cbiAgcHJpdmF0ZSBfaXNBYnNvbHV0ZShzcmM6IHN0cmluZykge1xuICAgIGlmIChzcmMgJiYgKHNyYy5zbGljZSgwLCA1KSA9PT0gXCJodHRwOlwiIHx8IHNyYy5zbGljZSgwLCA2KSA9PT0gXCJodHRwczpcIiB8fCBzcmMuc2xpY2UoMCwgMikgPT09IFwiLy9cIiB8fCBzcmMuc2xpY2UoMCwgNSkgPT09IFwiZGF0YTpcIikpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufSJdfQ==